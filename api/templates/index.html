<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CarbonTracker Pro - Carbon Emission Management</title>
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/style.css{% if cache_bust %}?v={{ cache_bust }}{% endif %}">
    <!-- Theme Fix CSS -->
    <link rel="stylesheet" href="/static/css/theme-fix.css">
    <!-- Images CSS -->
    <link rel="stylesheet" href="/static/css/images.css">
    <!-- Optimized Layout CSS -->
    <link rel="stylesheet" href="/static/css/optimized-layout.css{% if cache_bust %}?v={{ cache_bust }}{% endif %}">
    <!-- Theme CSS -->
    <link rel="stylesheet" href="/static/css/theme.css">
    <!-- Component Styles -->
    <link rel="stylesheet" href="/static/css/components.css">
    <script>
        // Basic app configuration
        window.APP_CONFIG = Object.assign({}, window.APP_CONFIG || {}, {
            backendUrl: '{{ backend_url | default("") }}'  // Let Jinja2 template engine fill this
        });
    </script>
    <style>
        /* Custom scrollbar styles */
        .card-body::-webkit-scrollbar {
            width: 6px;
        }
        
        .card-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .card-body::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        
        .card-body::-webkit-scrollbar-thumb:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        /* Database management styles */
        #dbManagementContent {
            transition: max-height 0.3s ease-in-out;
        }

        #dbManagementContent .card-body {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.1);
        }

        .database-info .list-group-item {
            transition: background-color 0.2s ease;
        }

        .database-info .list-group-item:hover {
            background-color: rgba(255, 255, 255, 0.05) !important;
        }

        .database-actions .btn {
            transition: all 0.2s ease;
        }

        .database-actions .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <!-- Login Screen (hidden by default) -->
    <div id="login-screen" class="screen" style="display: none;">
        <div class="container-fluid vh-100 d-flex align-items-center justify-content-center login-bg">
                <div class="row w-100 justify-content-center">
                    <!-- Login form hidden but preserved for future use if needed -->
                    <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5 mx-auto" style="display: none;">
                    <!-- Animated Background -->
                    <div class="login-bg-animation mb-4">
                        <div class="text-center">
                            <i class="bi bi-leaf text-success" style="font-size: 3rem;"></i>
                            <div class="factory-smoke mt-2">
                                <i class="bi bi-cloud text-secondary opacity-75"></i>
                                <i class="bi bi-cloud text-secondary opacity-50"></i>
                                <i class="bi bi-cloud text-secondary opacity-25"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Login Card -->
                    <div class="card shadow-lg border-0 bg-dark">
                        <div class="card-header text-center border-0 bg-transparent">
                            <h1 class="h3 text-success mb-2">
                                <i class="bi bi-leaf me-2"></i>CarbonTracker Pro
                            </h1>
                            <p class="text-muted mb-0">Professional Carbon Emission Management</p>
                        </div>
                        
                        <div class="card-body p-4">
                            <h4 class="card-title text-center mb-4 text-light">Sign In</h4>
                            
                            <!-- Login Form -->
                            <!-- Use novalidate so our JS can handle validation and role auto-selection -->
                            <form id="login-form" method="post" action="/login" novalidate>
                                <div class="mb-4">
                                    <label for="email" class="form-label h6 mb-2">
                                        <i class="bi bi-envelope me-2"></i>Email Address
                                    </label>
                                    <input type="email" id="email" name="username" class="form-control form-control-lg" placeholder="Enter your email" required>
                                </div>
                                
                                <div class="mb-4">
                                    <label for="password" class="form-label h6 mb-2">
                                        <i class="bi bi-lock me-2"></i>Password
                                    </label>
                                    <input type="password" id="password" name="password" class="form-control form-control-lg" placeholder="Enter your password" required>
                                </div>
                                
                                <div class="mb-4">
                                    <label for="role" class="form-label h6 mb-2">
                                        <i class="bi bi-person-badge me-2"></i>User Role
                                    </label>
                                    <!-- Role is optional; JS will auto-detect for demo logins and backend doesn't require it -->
                                    <select id="role" name="role" class="form-select form-select-lg">
                                        <option value="">Select your role</option>
                                        <option value="admin">Administrator</option>
                                        <option value="company">Company Manager</option>
                                        <option value="viewer">Analyst/Viewer</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="btn btn-success btn-lg w-100 mb-3">
                                    <i class="bi bi-box-arrow-in-right me-2"></i>Sign In
                                </button>
                            </form>
                            
                            <!-- Error Display -->
                            {% if login_error %}
                            <div class="alert alert-danger" role="alert">
                                <i class="bi bi-exclamation-triangle me-2"></i>{{ login_error }}
                            </div>
                            {% endif %}
                            
                            <!-- Demo Credentials -->
                            <div class="mt-4 p-3 bg-secondary bg-opacity-25 rounded">
                                <h6 class="text-warning mb-2">
                                    <i class="bi bi-info-circle me-1"></i>Demo Credentials:
                                </h6>
                                <small class="text-muted d-block">Admin: admin@carbontracker.com / admin123</small>
                                <small class="text-muted d-block">Company: sarah@steelcorp.com / company123</small>
                                <small class="text-muted d-block">Viewer: mike@consulting.com / viewer123</small>
                            </div>
                            
                            <!-- Sign Up and Forgot Password Links -->
                            <div class="text-center mt-4">
                                <div class="d-flex justify-content-between">
                                    <button type="button" class="btn btn-link text-info" data-bs-toggle="modal" data-bs-target="#signupModal">
                                        <i class="bi bi-person-plus me-1"></i>Create Account
                                    </button>
                                    <button type="button" class="btn btn-link text-warning" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal">
                                        <i class="bi bi-key me-1"></i>Forgot Password?
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="screen">
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom sticky-top">
            <div class="container-fluid">
                <!-- Brand -->
                <a class="navbar-brand fw-bold" href="#">
                    <i class="bi bi-leaf text-success me-2"></i>CarbonTracker Pro
                </a>
                
                <!-- Mobile Toggle -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <!-- Navigation Links -->
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-page="dashboard">
                                <i class="bi bi-speedometer2 me-1"></i>Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="calculator">
                                <i class="bi bi-calculator me-1"></i>Calculator
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="packaging">
                                <i class="bi bi-box me-1"></i>Packaging
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="credits">
                                <i class="bi bi-currency-dollar me-1"></i>Carbon Credits
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-page="analytics">
                                <i class="bi bi-graph-up me-1"></i>Analytics
                            </a>
                        </li>
                        <li class="nav-item admin-only">
                            <a class="nav-link" href="#" data-page="admin">
                                <i class="bi bi-gear me-1"></i>Admin Panel
                            </a>
                        </li>
                        <!-- Theme Toggle Button -->
                        <li class="nav-item">
                            <button class="btn btn-outline-light ms-2 theme-toggle" id="themeToggle">
                                <i class="bi bi-sun-fill" id="themeIcon"></i>
                            </button>
                        </li>
                    </ul>
                    
                    <!-- User Menu -->
                    <div class="navbar-nav">
                        <div class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle me-1"></i><span id="user-name">User</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a></li>
                                <li><a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="#" id="logout-btn"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <div class="container py-4">
                <!-- Dashboard content will be here -->
                
                <!-- Contact Section -->
                <div class="row justify-content-center mt-5">
                    <div class="col-lg-8">
                        <div class="card border-secondary">
                            <div class="card-body text-center p-5">
                                <div class="mb-4">
                                    <i class="bi bi-headset text-success" style="font-size: 3rem;"></i>
                                </div>
                                <h2 class="card-title mb-3 text-light">Contact Us</h2>
                                <p class="card-text text-muted mb-4">Have questions about our carbon tracking dashboard? Get in touch with our team and we'll be happy to help you track and reduce your carbon emissions effectively.</p>
                                <div class="d-flex justify-content-center gap-3">
                                    <a href="mailto:support@carbontrack.com" class="btn btn-outline-success">
                                        <i class="bi bi-envelope me-2"></i>Email Us
                                    </a>
                                    <a href="#feedback" class="btn btn-outline-info" data-bs-toggle="modal" data-bs-target="#feedbackModal">
                                        <i class="bi bi-chat-text me-2"></i>Write Back
                                    </a>
                                </div>
                                <div class="mt-4 pt-4 border-top border-secondary">
                                    <div class="row text-center">
                                        <div class="col-md-4">
                                            <i class="bi bi-clock text-success mb-3" style="font-size: 1.5rem;"></i>
                                            <h6 class="text-light">24/7 Support</h6>
                                            <small class="text-muted">Always here to help</small>
                                        </div>
                                        <div class="col-md-4">
                                            <i class="bi bi-geo-alt text-success mb-3" style="font-size: 1.5rem;"></i>
                                            <h6 class="text-light">Global Coverage</h6>
                                            <small class="text-muted">International support</small>
                                        </div>
                                        <div class="col-md-4">
                                            <i class="bi bi-shield-check text-success mb-3" style="font-size: 1.5rem;"></i>
                                            <h6 class="text-light">Expert Team</h6>
                                            <small class="text-muted">Certified specialists</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

      
                
              
                

        <!-- Calculator Page -->
        <div id="calculator-page" class="page">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="card bg-dark border-secondary">
                            <div class="card-header bg-transparent border-secondary">
                                <h2 class="card-title mb-1 text-light">
                                    <i class="bi bi-leaf me-2 text-success"></i>Carbon Emission Calculator
                                </h2>
                                <p class="card-text text-muted mb-0">Calculate emissions with AI-powered predictions</p>
                            </div>
                            
                            <div class="card-body">
                                <form id="emission-form">
                                    <div class="row g-3 mb-4">
                                        <div class="col-md-6">
                                            <label for="industry" class="form-label text-light">
                                                <i class="bi bi-building me-1"></i>Industry Type
                                            </label>
                                            <select id="industry" name="industry" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="">Select industry</option>
                                                <!-- Options populated by JavaScript -->
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label for="production" class="form-label text-light">
                                                <i class="bi bi-gear me-1"></i>Production Volume
                                            </label>
                                            <input type="number" id="production" class="form-control bg-dark border-secondary text-light" placeholder="Enter production volume" required>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label for="time-period" class="form-label text-light">
                                                <i class="bi bi-calendar me-1"></i>Time Period
                                            </label>
                                            <select id="time-period" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="daily">Daily</option>
                                                <option value="monthly">Monthly</option>
                                                <option value="annually">Annually</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label for="energy-source" class="form-label text-light">
                                                <i class="bi bi-lightning me-1"></i>Primary Energy Source
                                            </label>
                                            <select id="energy-source" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="coal">Coal</option>
                                                <option value="natural-gas">Natural Gas</option>
                                                <option value="renewable">Renewable</option>
                                                <option value="mixed">Mixed</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                        <button type="submit" class="btn btn-success btn-lg px-4">
                                            <i class="bi bi-calculator me-2"></i>Calculate Emissions
                                        </button>
                                        <button type="button" id="ai-predict-btn" class="btn btn-outline-info btn-lg px-4">
                                            <i class="bi bi-robot me-2"></i>AI Prediction
                                        </button>
                                    </div>
                                </form>
                                
                                <div id="calculation-results" class="mt-4">
                                    <!-- Results populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Packaging Page -->
        <div id="packaging-page" class="page">
            <div class="container py-4">
                <div class="row justify-content-center">
                    <div class="col-lg-8 mx-auto">
                        <!-- Main Calculator Card -->
                        <div class="packaging-container">
                            <div class="mb-4">
                                <h2 class="mb-2">
                                    <i class="bi bi-box me-2 text-warning"></i>Packaging Carbon Footprint Calculator
                                </h2>
                                <p class="text-muted mb-0">Calculate emissions with AI-powered predictions for packaging materials</p>
                            </div>
                            
                            <div class="p-0">
                                <form id="packaging-form">
                                    <div class="row g-3 mb-4">
                                        <div class="col-lg-4 col-md-6">
                                            <label for="material-type" class="form-label text-light">
                                                <i class="bi bi-tags me-1"></i>Material Type
                                            </label>
                                            <select id="material-type" name="material-type" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="">Select material type</option>
                                                <option value="plastics">Plastics</option>
                                                <option value="paper">Paper/Cardboard</option>
                                                <option value="glass">Glass</option>
                                                <option value="metals">Metals</option>
                                                <option value="fuels">Fuels</option>
                                                <option value="transportation">Transportation</option>
                                                <option value="waste">Waste Management</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-lg-4 col-md-6">
                                            <label for="material-subtype" class="form-label text-light">
                                                <i class="bi bi-tag me-1"></i>Material Subtype
                                            </label>
                                            <select id="material-subtype" name="material-subtype" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="">Select material type first</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-lg-4 col-md-6">
                                            <label for="packaging-amount" class="form-label text-light">
                                                <i class="bi bi-123 me-1"></i>Amount
                                            </label>
                                            <input id="packaging-amount" name="amount" type="number" class="form-control bg-dark border-secondary text-light" placeholder="Enter amount" min="0" step="any" required>
                                            <div class="form-text text-muted" id="amount-unit">Enter amount in kg</div>
                                        </div>
                                        
                                        <div class="col-lg-3 col-md-6" id="product-state-container">
                                            <label for="product-state" class="form-label text-light">
                                                <i class="bi bi-droplet me-1"></i>Product State
                                            </label>
                                            <select id="product-state" name="state" class="form-select bg-dark border-secondary text-light" required>
                                                <option value="solid" data-unit="kg">Solid (kg)</option>
                                                <option value="liquid" data-unit="litre">Liquid (litre)</option>
                                                <option value="gas" data-unit="psi">Gas (psi)</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-lg-3 col-md-6">
                                            <label for="is-recycled" class="form-label text-light">
                                                <i class="bi bi-recycle me-1"></i>Material Source
                                            </label>
                                            <select id="is-recycled" name="is-recycled" class="form-select bg-dark border-secondary text-light">
                                                <option value="false">Virgin Material</option>
                                                <option value="true">Recycled Material</option>
                                            </select>
                                        </div>
                                        
                                        <div class="col-lg-3 col-md-6">
                                            <label for="transport-distance" class="form-label text-light">
                                                <i class="bi bi-geo me-1"></i>Transport Distance
                                            </label>
                                            <input id="transport-distance" name="distance" type="number" class="form-control bg-dark border-secondary text-light" placeholder="Distance in km" min="0" step="any" value="0">
                                            <div class="form-text text-muted">Enter distance in km</div>
                                        </div>
                                        
                                        <div class="col-lg-3 col-md-6">
                                            <label for="transport-mode" class="form-label text-light">
                                                <i class="bi bi-truck me-1"></i>Transport Mode
                                            </label>
                                            <select id="transport-mode" name="transport-mode" class="form-select bg-dark border-secondary text-light">
                                                <option value="truck">Truck</option>
                                                <option value="ship">Ship</option>
                                                <option value="rail">Rail</option>
                                                <option value="air">Air Freight</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                        <button type="submit" class="btn btn-success btn-lg px-4">
                                            <i class="bi bi-calculator me-2"></i>Calculate Emissions
                                        </button>
                                        <button type="button" id="packaging-optimize-btn" class="btn btn-outline-warning btn-lg px-4">
                                            <i class="bi bi-magic me-2"></i>AI Optimization
                                        </button>
                                    </div>
                                </form>
                                
                                <div id="packaging-results" class="mt-4">
                                    <!-- Results populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Admin Panel Section -->
                        <div class="card bg-dark border-secondary mt-4">
                            <div class="card-header bg-transparent border-secondary">
                                <h4 class="card-title mb-1 text-light">
                                    <i class="bi bi-gear me-2"></i>Packaging Management
                                </h4>
                                <p class="card-text text-muted mb-0">System management for packaging materials and sustainability metrics</p>
                            </div>
                            
                            <div class="card-body">
                                <div class="row g-4 justify-content-center">
                                    <div class="col-md-4">
                                        <div class="card bg-secondary bg-opacity-25 border-0">
                                            <div class="card-body text-center">
                                                <i class="bi bi-bar-chart text-info mb-3" style="font-size: 2rem;"></i>
                                                <h6 class="card-title text-light">Material Analytics</h6>
                                                <div class="row text-center mt-3">
                                                    <div class="col">
                                                        <h4 class="text-info mb-0">6</h4>
                                                        <small class="text-muted">Active Materials</small>
                                                    </div>
                                                    <div class="col">
                                                        <h4 class="text-info mb-0">2.1</h4>
                                                        <small class="text-muted">Avg Emission Factor</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <div class="card bg-secondary bg-opacity-25 border-0">
                                            <div class="card-body text-center">
                                                <i class="bi bi-leaf text-success mb-3" style="font-size: 2rem;"></i>
                                                <h6 class="card-title text-light">Sustainability Score</h6>
                                                <div class="row text-center mt-3">
                                                    <div class="col">
                                                        <h4 class="text-success mb-0">B+</h4>
                                                        <small class="text-muted">Overall Grade</small>
                                                    </div>
                                                    <div class="col">
                                                        <h4 class="text-success mb-0">74%</h4>
                                                        <small class="text-muted">Efficiency</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-4">
                                        <div class="card bg-secondary bg-opacity-25 border-0">
                                            <div class="card-body text-center">
                                                <i class="bi bi-lightbulb text-warning mb-3" style="font-size: 2rem;"></i>
                                                <h6 class="card-title text-light">Quick Actions</h6>
                                                <div class="d-grid gap-2 mt-3">
                                                    <button class="btn btn-sm btn-outline-light">Material Comparison</button>
                                                    <button class="btn btn-sm btn-outline-light">Export Report</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Carbon Credits Page -->
        <div id="credits-page" class="page">
            <div class="container py-4">
                <div class="row mb-4">
                    <div class="col">
                        <h1 class="h3 text-light mb-2">Carbon Credits Marketplace</h1>
                        <p class="text-muted">Trade and manage your carbon credit portfolio</p>
                    </div>
                </div>
                
                <div class="row g-4">
                    <!-- Price Ticker -->
                    <div class="col-12">
                        <div class="card bg-dark border-secondary">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-4">
                                        <h5 class="text-light mb-1">Current Price: <span class="text-success">$6.97</span></h5>
                                        <small class="text-success"><i class="bi bi-arrow-up me-1"></i>+0.3%</small>
                                    </div>
                                    <div class="col-md-8">
                                        <small class="text-muted">Range: $4.80 - $7.37</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Portfolio & Credit Types -->
                    <div class="col-lg-6">
                        <div class="card bg-dark border-secondary h-100">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">Your Portfolio</h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3 mb-3">
                                    <div class="col-sm-4 text-center">
                                        <h4 class="text-light mb-1">2,000</h4>
                                        <small class="text-muted">Total Credits</small>
                                    </div>
                                    <div class="col-sm-4 text-center">
                                        <h4 class="text-light mb-1">$13,940</h4>
                                        <small class="text-muted">Total Value</small>
                                    </div>
                                    <div class="col-sm-4 text-center">
                                        <h4 class="text-danger mb-1">-450</h4>
                                        <small class="text-muted">Credits Needed</small>
                                    </div>
                                </div>
                                <button class="btn btn-success w-100">
                                    <i class="bi bi-cart-plus me-2"></i>Buy Credits
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <div class="card bg-dark border-secondary h-100">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">Available Credit Types</h5>
                            </div>
                            <div class="card-body">
                                <div id="credit-types-list">
                                    <!-- Credit types populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics-page" class="page">
            <div class="container py-4">
                <div class="row mb-4">
                    <div class="col">
                        <h1 class="h3 text-light mb-2">Analytics & Reports</h1>
                        <p class="text-muted">Detailed emission trends and forecasts</p>
                    </div>
                </div>
                
                <div class="row g-4 mb-4">
                    <div class="col-lg-8">
                        <div class="card bg-dark border-secondary">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">Monthly Emission Trends</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="chart-container" style="height: 400px;">
                                    <canvas id="trend-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="card bg-dark border-secondary h-100">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">Industry Comparison</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="chart-container" style="height: 400px;">
                                    <canvas id="industry-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col">
                        <div class="card bg-dark border-secondary">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">
                                    <i class="bi bi-robot me-2"></i>AI Predictions & Recommendations
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-4">
                                    <div class="col-md-4">
                                        <div class="text-center">
                                            <h4 class="text-info mb-1">Next Month Forecast</h4>
                                            <h2 class="text-light mb-1">2,450</h2>
                                            <small class="text-muted">tonnes CO₂e</small>
                                            <div class="mt-2">
                                                <span class="badge bg-info bg-opacity-25 text-info">87% confidence</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div id="ai-recommendations">
                                            <!-- Recommendations populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="admin-page" class="page admin-only">
            <div class="container py-4">
                <div class="row mb-4">
                    <div class="col">
                        <h1 class="h3 text-light mb-2">Admin Panel</h1>
                        <p class="text-muted">System management and user administration</p>
                    </div>
                </div>
                
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card bg-dark border-secondary">
                            <div class="card-header bg-transparent border-secondary d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0 text-light">User Management</h5>
                                <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#addUserModal">
                                    <i class="bi bi-plus me-1"></i>Add User
                                </button>
                            </div>
                            <div class="card-body">
                                <div id="user-list">
                                    <!-- Users populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="card bg-dark border-secondary mb-4">
                            <div class="card-header bg-transparent border-secondary">
                                <h5 class="card-title mb-0 text-light">System Statistics</h5>
                            </div>
                            <div class="card-body">
                                <div class="row g-3 text-center">
                                    <div class="col-6">
                                        <h4 class="text-light mb-0">127</h4>
                                        <small class="text-muted">Total Users</small>
                                    </div>
                                    <div class="col-6">
                                        <h4 class="text-light mb-0">45</h4>
                                        <small class="text-muted">Active Companies</small>
                                    </div>
                                    <div class="col-6">
                                        <h4 class="text-light mb-0">145,230</h4>
                                        <small class="text-muted">Tonnes Tracked</small>
                                    </div>
                                    <div class="col-6">
                                        <h4 class="text-light mb-0">89,450</h4>
                                        <small class="text-muted">Credits Traded</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card bg-dark border-secondary">
                            <div class="card-header bg-transparent border-secondary d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0 text-light">Database Management</h5>
                                <button class="btn btn-sm btn-outline-info" data-bs-toggle="collapse" data-bs-target="#dbManagementContent">
                                    <i class="bi bi-chevron-down"></i>
                                </button>
                            </div>
                            <div class="collapse show" id="dbManagementContent">
                                <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                                    <div class="database-actions d-grid gap-2">
                                        <button class="btn btn-outline-secondary">
                                            <i class="bi bi-download me-2"></i>Export Data
                                        </button>
                                        <button class="btn btn-outline-secondary">
                                            <i class="bi bi-upload me-2"></i>Import Data
                                        </button>
                                        <button class="btn btn-outline-secondary">
                                            <i class="bi bi-shield-check me-2"></i>Backup System
                                        </button>
                                        <button class="btn btn-outline-info">
                                            <i class="bi bi-file-text me-2"></i>System Logs
                                        </button>
                                    </div>
                                    <div class="database-info mt-3">
                                        <div class="list-group list-group-flush">
                                            <div class="list-group-item bg-dark text-light border-secondary">
                                                <div class="d-flex justify-content-between">
                                                    <span>Last Backup</span>
                                                    <small class="text-muted">2 hours ago</small>
                                                </div>
                                            </div>
                                            <div class="list-group-item bg-dark text-light border-secondary">
                                                <div class="d-flex justify-content-between">
                                                    <span>Database Size</span>
                                                    <small class="text-muted">1.2 GB</small>
                                                </div>
                                            </div>
                                            <div class="list-group-item bg-dark text-light border-secondary">
                                                <div class="d-flex justify-content-between">
                                                    <span>Total Tables</span>
                                                    <small class="text-muted">24</small>
                                                </div>
                                            </div>
                                            <div class="list-group-item bg-dark text-light border-secondary">
                                                <div class="d-flex justify-content-between">
                                                    <span>Active Connections</span>
                                                    <small class="text-muted">8</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-light">Add New User</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="add-user-form">
                        <div class="mb-3">
                            <label for="newUserEmail" class="form-label text-light">Email</label>
                            <input type="email" class="form-control bg-dark border-secondary text-light" id="newUserEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="newUserName" class="form-label text-light">Name</label>
                            <input type="text" class="form-control bg-dark border-secondary text-light" id="newUserName">
                        </div>
                        <div class="mb-3">
                            <label for="newUserPassword" class="form-label text-light">Password</label>
                            <input type="password" class="form-control bg-dark border-secondary text-light" id="newUserPassword" required>
                        </div>
                        <div class="mb-3">
                            <label for="newUserRole" class="form-label text-light">Role</label>
                            <select class="form-select bg-dark border-secondary text-light" id="newUserRole" required>
                                <option value="company">Company Manager</option>
                                <option value="viewer">Analyst/Viewer</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="save-user-btn">Add User</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div class="modal fade" id="signupModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-light">
                        <i class="bi bi-person-plus me-2"></i>Create New Account
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="signup-form">
                        <div class="mb-3">
                            <label for="signupName" class="form-label text-light">Full Name (Optional)</label>
                            <input type="text" class="form-control bg-dark border-secondary text-light" id="signupName" placeholder="Enter your full name">
                        </div>
                        <div class="mb-3">
                            <label for="signupEmail" class="form-label text-light">Email Address</label>
                            <input type="email" class="form-control bg-dark border-secondary text-light" id="signupEmail" placeholder="Enter your email" required>
                        </div>
                        <div class="mb-3">
                            <label for="signupPassword" class="form-label text-light">Password</label>
                            <input type="password" class="form-control bg-dark border-secondary text-light" id="signupPassword" placeholder="Create a password (min 6 characters)" required>
                        </div>
                        <div class="mb-3">
                            <label for="signupPasswordConfirm" class="form-label text-light">Confirm Password</label>
                            <input type="password" class="form-control bg-dark border-secondary text-light" id="signupPasswordConfirm" placeholder="Confirm your password" required>
                        </div>
                        <div class="alert alert-info d-none" id="signup-message"></div>
                        <div class="alert alert-danger d-none" id="signup-error"></div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="signup-btn">
                        <i class="bi bi-person-plus me-1"></i>Create Account
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-light">
                        <i class="bi bi-key me-2"></i>Reset Password
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="forgot-password-form">
                        <div class="mb-3">
                            <label for="resetEmail" class="form-label text-light">Email Address</label>
                            <input type="email" class="form-control bg-dark border-secondary text-light" id="resetEmail" placeholder="Enter your email address" required>
                        </div>
                        <div class="mb-3">
                            <label for="newPassword" class="form-label text-light">New Password</label>
                            <input type="password" class="form-control bg-dark border-secondary text-light" id="newPassword" placeholder="Enter new password (min 6 characters)" required>
                        </div>
                        <div class="mb-3">
                            <label for="confirmNewPassword" class="form-label text-light">Confirm New Password</label>
                            <input type="password" class="form-control bg-dark border-secondary text-light" id="confirmNewPassword" placeholder="Confirm your new password" required>
                        </div>
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <strong>Note:</strong> This will immediately reset your password. Make sure you remember your new password!
                        </div>
                        <div class="alert alert-success d-none" id="reset-message"></div>
                        <div class="alert alert-danger d-none" id="reset-error"></div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-warning" id="reset-password-btn">
                        <i class="bi bi-key me-1"></i>Reset Password
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal fade" id="feedbackModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title text-light">
                        <i class="bi bi-chat-text me-2"></i>Write to Us
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="feedback-form">
                        <div class="mb-3">
                            <label for="feedbackName" class="form-label text-light">Your Name</label>
                            <input type="text" class="form-control bg-dark border-secondary text-light" id="feedbackName" placeholder="Enter your name" required>
                        </div>
                        <div class="mb-3">
                            <label for="feedbackEmail" class="form-label text-light">Email Address</label>
                            <input type="email" class="form-control bg-dark border-secondary text-light" id="feedbackEmail" placeholder="Enter your email" required>
                        </div>
                        <div class="mb-3">
                            <label for="feedbackType" class="form-label text-light">Type of Feedback</label>
                            <select class="form-select bg-dark border-secondary text-light" id="feedbackType" required>
                                <option value="">Select type</option>
                                <option value="support">Technical Support</option>
                                <option value="feature">Feature Request</option>
                                <option value="bug">Bug Report</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="feedbackMessage" class="form-label text-light">Your Message</label>
                            <textarea class="form-control bg-dark border-secondary text-light" id="feedbackMessage" rows="4" placeholder="Type your message here..." required></textarea>
                        </div>
                        <div class="form-text text-muted mb-3">
                            Our team typically responds within 24 hours.
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" id="send-feedback-btn">
                        <i class="bi bi-send me-2"></i>Send Message
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-overlay">
        <div class="d-flex justify-content-center align-items-center vh-100">
            <div class="text-center">
                <div class="spinner-border text-success mb-3" style="width: 3rem; height: 3rem;" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="text-light">Loading CarbonTracker Pro...</p>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5.3 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom JS -->
    <script src="/static/js/app.js{% if cache_bust %}?v={{ cache_bust }}{% endif %}"></script>
    <!-- Real-time Chart JS -->
    <script src="/static/js/realtime-chart.js{% if cache_bust %}?v={{ cache_bust }}{% endif %}"></script>
    <!-- Animation JS -->
    <script src="/static/js/animations.js{% if cache_bust %}?v={{ cache_bust }}{% endif %}"></script>
    <!-- Theme JS -->
    <script src="/static/js/theme.js{% if cache_bust %}?v={{ cache_bust }}{% endif %}"></script>
</body>
</html>